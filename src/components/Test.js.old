import React, {useMemo, useState} from "react";
// import {getPages} from "../modules/getPages";
import {getNovels} from "../novels/novelController";
import {Scale} from "./Scale";

export const Test = () => {
    const [scales, setScales] = useState({});
    const [pages, setPages] = useState(null);
    const [pageDivs, setPageDivs] = useState(null);
    const outerStyle = {
        width: "100vw",
        height: "100vh",
        position: "fixed",
        top: 0,
        left: 0,
        margin: 0,
        padding: 0,
        color: "white",
        backgroundColor: "#282c34",
        display: "flex",
        justifyContent: "center",
        alignItems: "center",
        // textAlign: "center",
        // verticalAlign: "middle"
    }
    const innerStyle = {
        fontSize: "40px"
    }
    const pStyle = {
        userSelect: "none",
        cursor: "pointer",
    }
    const str = getNovels(1, 0);
    const getScales = (obj) => {
        setScales(obj);
    }
    useMemo(() => {
        const pages = getPages(str, scales);
        console.log("pages:");
        console.log(pages);
        setPages(pages);
    }, [scales]);
    useMemo(() => {
        let i = -1;
        // console.log("pages:");
        // console.log(pages);
        if(pages !== null && pages !== Promise){
            const divs = pages.map((page) => {
                const linesP = page.lines.map((line) => {
                    return <p>{ line }</p>;
                });
                i++;
                return (
                    <div key={"outer-" + i} style={outerStyle}>
                        <div key={"inner-" + i} id={"p-" + i} style={innerStyle}>
                            { linesP }
                        </div>
                    </div>
                );
            })
            setPageDivs(divs);
        }
        // return pages.map((page) => {
        //     const linesP = page.lines.map((line) => {
        //         return <p>{ line }</p>;
        //     });
        //     i++;
        //     return (
        //         <div key={"outer-" + i} style={outerStyle}>
        //             <div key={"inner-" + i} id={"p-" + i} style={innerStyle}>
        //                 { linesP }
        //             </div>
        //         </div>
        //     );
        // });
    }, [pages]);
    useMemo(() => {
        console.log(pageDivs);
    }, [pageDivs]);


    return (
        <>
            <div style={outerStyle}>
                <div style={innerStyle}>
                    {/*{ pageDivs }*/}
                </div>
            </div>
            <Scale getScales={(obj) => getScales(obj)}/>
        </>
    );
}